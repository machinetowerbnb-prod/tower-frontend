<div class="users-container">
  <div class="top-bar">
    <button class="send-email-btn">Send email to all user</button>

    <div class="right-controls">
      <label>Show</label>
      <select [(ngModel)]="pageSize" (change)="changePageSize(pageSize)">
        <option *ngFor="let size of [10, 20, 50, 100]" [value]="size">{{ size }}</option>
      </select>
      <label>entries</label>

      <input type="text" placeholder="Search..." [(ngModel)]="searchText" (input)="searchUsers()" />
    </div>
  </div>

  <div class="table-container">
    <table class="responsive-table">
      <thead>
        <tr>
          <th>SN</th>
          <th>Name</th>
          <th>Email</th>
          <th>Referral ID</th>
          <th>Working Wallet</th>
          <th>Withdraw Wallet</th>
          <th>Referrals</th>
          <th>Status</th>
          <th>Send Email</th> <!-- ⭐ NEW COLUMN -->
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let user of paginatedUsers; let i = index">

          <td>{{ (currentPage - 1) * pageSize + i + 1 }}</td>
          <td>{{ user.name }}</td>
          <td>{{ user.email }}</td>
          <td>{{ user.referralId }}</td>

          <!-- ⭐ FIXED width for wallet + button alignment -->
          <td class="wallet-cell">
            <span class="amount">{{ user.wallet }}</span>
            <button class="add-btn" (click)="openPopup('Deposit', user)">Add</button>
          </td>

          <td class="wallet-cell">
            <span class="amount">{{ user.earnings }}</span>
            <button class="add-btn" (click)="openPopup('Withdraw', user)">Add</button>
          </td>

          <td>{{ user.referrals }}</td>

          <!-- ⭐ TOGGLE switch instead of button -->
          <td>
            <label class="toggle-switch">
              <input type="checkbox" [checked]="user.status" (change)="toggleStatus(user)" />
              <span class="slider"></span>
            </label>
          </td>

          <!-- ⭐ NEW Send email column -->
          <td>
            <button class="email-btn" (click)="sendEmail(user)">
              <i class="fa fa-envelope"></i>
            </button>
          </td>

        </tr>
      </tbody>

    </table>
  </div>

  <!-- Pagination -->
  <div class="pagination-controls">
    <button (click)="prevPage()" [disabled]="currentPage === 1">Prev</button>
    <span>Page {{ currentPage }} of {{ Math.ceil(filteredUsers.length / pageSize) }}</span>
    <button (click)="nextPage()" [disabled]="currentPage * pageSize >= filteredUsers.length">
      Next
    </button>
  </div>
</div>


<app-update-amount [show]="showPopup" [actionType]="selectedAction" [rowData]="selectedRow" (close)="closePopup()"
  (submitData)="handleSubmit($event)"></app-update-amount>